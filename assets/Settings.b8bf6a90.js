import{s as T,B as h,r as p,o as H,b6 as k,a as I,c as x,b as s,f as t,i as j,t as u,w as l,v as m,bq as b,H as z,I as G}from"./index.198dde65.js";import{_ as J,u as K,e as L,f as O,h as Q,i as W}from"./plugin-vue_export-helper.7637a18b.js";import{i as c,a as q,b as y,c as E}from"./validate.1e8f3dbb.js";const i=_=>(z("data-v-1c040ba4"),_=_(),G(),_),X={class:"headshot-wrap"},Y={class:"headshot"},Z=["src"],$=i(()=>s("i",{class:"icon-plus"},null,-1)),ss={class:"api-error"},as={class:"content"},es={class:"inner"},os=i(()=>s("h2",null,"\u7DE8\u8F2F\u500B\u4EBA\u8CC7\u6599",-1)),rs=["data-warning"],ts=i(()=>s("span",null,"\u4F7F\u7528\u8005\u540D\u7A31",-1)),ds={class:"form-row form-radio"},ns=i(()=>s("p",null,"\u4F7F\u7528\u8005\u6027\u5225",-1)),is={for:"male"},ls=i(()=>s("div",{class:"fake-radio"},null,-1)),cs=i(()=>s("span",null,"\u7537\u6027",-1)),ps={for:"female"},us=i(()=>s("div",{class:"fake-radio"},null,-1)),_s=i(()=>s("span",null,"\u5973\u6027",-1)),ms={for:"unknown"},ws=i(()=>s("div",{class:"fake-radio"},null,-1)),fs=i(()=>s("span",null,"\u672A\u77E5\u5B87\u5B99\u751F\u7269",-1)),gs={class:"api-error"},vs={class:"api-success"},hs=i(()=>s("h2",null,"\u91CD\u65B0\u8A2D\u5B9A\u5BC6\u78BC",-1)),ks=["data-warning"],bs=i(()=>s("span",null,"\u539F\u5BC6\u78BC",-1)),ys=["data-warning"],Ns=i(()=>s("span",null,"\u4F7F\u7528\u8005\u5BC6\u78BC",-1)),Ps=["data-warning"],Ss=i(()=>s("span",null,"\u78BA\u8A8D\u4F7F\u7528\u8005\u5BC6\u78BC",-1)),Ms={class:"api-error"},Us={class:"api-success"},Is={setup(_){const N=K(),{patchUser:F}=N;let{name:P,gender:S,image:B,_id:C}=T(N);const e=h({name:"",gender:0,image:"",old_password:"",password:"",confirm_password:""}),w=p(null),f=p(null),M=p(null),g=p(null),v=p(null),r=h({image:B.value,nickName:P.value,gender:S?S.value:2}),D=async()=>{const{data:a}=await L();a.status==="success"&&(r.nickName=a.data.nickName,r.gender=a.data.gender,r.image=a.data.avatar)};H(()=>{P||D()});const U=p(),V=async()=>{console.log("upload");const a=U.value.files[0];console.dir(a);const o=new FormData;o.append("file-to-upload",a);const{data:n}=await O(o);n.status==="success"?r.image=n.data.upload:M.value=n.message};k(r,(a,o)=>{a&&(v.value=""),e.nickName=c(a.nickName),e.gender=c(a.gender)},{deep:!0});const R=async()=>{if(e.nickName=c(r.nickName),e.nickName)return;const a={id:C.value,data:{nickName:r.nickName.trim(),gender:r.gender}};r.image&&(a.data.avatar=r.image);const{data:o}=await Q(a);o.status==="success"?(v.value="\u4FEE\u6539\u6210\u529F",g.value="",F({name:o.data.nickName,gender:o.data.gender,image:o.data.avatar})):g.value=o.message},d=h({old_password:"",password:"",confirm_password:""});k(d,a=>{a&&(f.value=""),e.old_password=c(a.old_password),e.confirm_password=q(a.password,a.confirm_password)},{deep:!0}),k(()=>d.password,a=>y(a)?e.password=y(a):e.password=E(a,d.old_password));const A=async()=>{if(e.old_password=c(d.old_password),e.password=c(d.password),e.confirm_password=c(d.confirm_password),e.old_password||e.password||e.confirm_password||(e.confirm_password=q(d.password,d.confirm_password),e.confirm_password)||(e.confirm_password=y(d.password),e.confirm_password)||(e.password=E(d.password,d.old_password),e.password))return;const{data:a}=await W(d);a.status==="success"?(f.value=a.message,w.value=""):w.value=a.message};return(a,o)=>(I(),x("section",null,[s("div",X,[s("label",Y,[s("input",{type:"file",onChange:V,ref_key:"fileInput",ref:U},null,544),t(r).image?(I(),x("img",{key:0,src:t(r).image,alt:""},null,8,Z)):j("",!0)]),$,s("div",ss,u(M.value),1)]),s("div",as,[s("div",es,[os,s("form",null,[s("label",{class:"form-row","data-warning":t(e).nickName},[l(s("input",{id:"name",type:"text",required:"","onUpdate:modelValue":o[0]||(o[0]=n=>t(r).nickName=n)},null,512),[[m,t(r).nickName]]),ts],8,rs),s("div",ds,[ns,s("label",is,[l(s("input",{name:"gender",id:"male",value:"0",type:"radio","onUpdate:modelValue":o[1]||(o[1]=n=>t(r).gender=n)},null,512),[[b,t(r).gender]]),ls,cs]),s("label",ps,[l(s("input",{name:"gender",id:"female",value:"1",type:"radio","onUpdate:modelValue":o[2]||(o[2]=n=>t(r).gender=n)},null,512),[[b,t(r).gender]]),us,_s]),s("label",ms,[l(s("input",{name:"gender",id:"unknown",value:"2",type:"radio","onUpdate:modelValue":o[3]||(o[3]=n=>t(r).gender=n)},null,512),[[b,t(r).gender]]),ws,fs])]),s("div",gs,u(g.value),1),s("div",vs,u(v.value),1),s("div",{class:"rect-btn fill submit-btn",onClick:R}," \u4FEE\u6539\u500B\u4EBA\u8CC7\u6599 ")]),hs,s("form",null,[s("label",{class:"form-row","data-warning":t(e).old_password},[l(s("input",{id:"old-password",type:"password",required:"","onUpdate:modelValue":o[4]||(o[4]=n=>t(d).old_password=n)},null,512),[[m,t(d).old_password,void 0,{trim:!0}]]),bs],8,ks),s("label",{class:"form-row","data-warning":t(e).password},[l(s("input",{id:"password",type:"password",required:"","onUpdate:modelValue":o[5]||(o[5]=n=>t(d).password=n)},null,512),[[m,t(d).password,void 0,{trim:!0}]]),Ns],8,ys),s("label",{class:"form-row","data-warning":t(e).confirm_password},[l(s("input",{id:"confirm-password",type:"password",required:"","onUpdate:modelValue":o[6]||(o[6]=n=>t(d).confirm_password=n)},null,512),[[m,t(d).confirm_password,void 0,{trim:!0}]]),Ss],8,Ps),s("div",Ms,u(w.value),1),s("div",Us,u(f.value),1)]),s("div",{class:"rect-btn fill submit-btn",onClick:A}," \u4FEE\u6539\u5BC6\u78BC ")])])]))}};var Fs=J(Is,[["__scopeId","data-v-1c040ba4"]]);export{Fs as default};
