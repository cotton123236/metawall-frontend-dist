var k=Object.defineProperty,y=Object.defineProperties;var v=Object.getOwnPropertyDescriptors;var m=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var f=(e,s,t)=>s in e?k(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,p=(e,s)=>{for(var t in s||(s={}))_.call(s,t)&&f(e,t,s[t]);if(m)for(var t of m(s))b.call(s,t)&&f(e,t,s[t]);return e},$=(e,s)=>y(e,v(s));import{a as P,s as E,N as d,O as w,d as I}from"./index.5fa64727.js";const{VITE_API_URL:h}={VITE_API_URL:"https://obscure-temple-95558.herokuapp.com",VITE_GOOGLE_OAUTH_LOGIN_URL:"https://obscure-temple-95558.herokuapp.com/auth/google",VITE_ENV:"production",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},o={user:`${h}/users`,post:`${h}/posts`},O=P(),{useModalAlert:i,useModalAlertText:l}=E(O),r=d.create({baseURL:"http://127.0.0.1:3005"});d.defaults.timeout=1e3;d.defaults.retry=4;d.defaults.retryDelay=1e3;r.interceptors.request.use(e=>(localStorage.getItem("token")&&(e.headers.Authorization="Bearer "+localStorage.getItem("token")),e),e=>(e.method.toUpperCase(),e),e=>e,e=>Promise.reject(e));r.interceptors.response.use(e=>{var t;return $(p({},e),{target:((t=e==null?void 0:e.data)==null?void 0:t.data)||{}})},e=>{if(e.response){const{status:t}=e.response,{name:a}=e.response.data.error,{message:n}=e.response.data;switch(t){case 400:i.value=!0;let u="";switch(a){case"40001":u=`\uFF0C${n}`,l.value=`\u683C\u5F0F\u932F\u8AA4${u}`;break;case"40002":u=`\uFF0C${n}`,n.includes("\u60A8\u7684\u5BC6\u78BC\u4E0D\u6B63\u78BA")&&(u="\uFF0C\u5E33\u865F\u6216\u5BC6\u78BC\u932F\u8AA4"),n.includes("\u5DF2\u8A3B\u518A\u6B64\u7528\u6236")&&(u="\uFF0C\u6B64 Email \u5DF2\u88AB\u8A3B\u518A"),n.includes("\u60A8\u7684\u820A\u5BC6\u78BC\u4E0D\u6B63\u78BA")&&(u="\uFF0C\u60A8\u7684\u539F\u5BC6\u78BC\u4E0D\u6B63\u78BA"),l.value=`\u5167\u5BB9\u932F\u8AA4${u}`;break;case"40003":l.value="\u4F60\u5C1A\u672A\u767B\u5165",w.push({name:"login"});break;case"40004":u=`\uFF0C${n}`,l.value=`\u64CD\u4F5C\u932F\u8AA4${u}`;break;case"40005":n.includes("large")&&(u="\uFF0C\u6A94\u6848\u8D85\u904E 2MB \u9650\u5236\uFF0C\u8ACB\u91CD\u65B0\u4E0A\u50B3"),l.value=`\u932F\u8AA4${u}`;break;case"40010":u=`\uFF0C${n}`,n.includes("\u4E0D\u5B58\u5728\u8A72\u7B46\u8CC7\u6599")&&(u="\uFF0C\u6B64 Email \u5C1A\u672A\u8A3B\u518A"),l.value=`ID \u932F\u8AA4${u}`;break;case"40011":l.value="Mongoose \u5B58\u5728\u91CD\u8907\u7684 _id";break;default:l.value="\u683C\u5F0F\u932F\u8AA4";break}break;case 401:i.value=!0,l.value="\u8EAB\u4EFD\u9A57\u8B49\u932F\u8AA4";case 404:break;case 500:switch(i.value=!0,a){case"50001":l.value="\u932F\u8AA4\uFF0C\u50C5\u63A5\u53D7\u683C\u5F0F jpg, png, jpeg\uFF0C\u8ACB\u91CD\u65B0\u4E0A\u50B3";break;default:l.value=`${t}: \u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u6D3D\u7CFB\u7D71\u7BA1\u7406\u54E1`;break}break;default:i.value=!0,l.value=`${t}: \u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u6D3D\u7CFB\u7D71\u7BA1\u7406\u54E1`;break}}if(e.code==="ECONNABORTED"&&e.message.indexOf("timeout")!==-1){const{config:t}=e;if(t.__retryCount=t.__retryCount||0,t.__retryCount>=t.retry)return Promise.reject(e);t.__retryCount+=1;var s=new Promise(function(a){setTimeout(function(){i.value=!0,l.value="\u4F3A\u670D\u5668\u6C92\u6709\u5373\u6642\u56DE\u61C9\uFF0C\u6B63\u5728\u5617\u8A66\u91CD\u65B0\u8ACB\u6C42\u670D\u52D9...",a()},t.retryDelay||1)});return s.then(()=>d(t)).finally(()=>{}).catch(a=>{i.value=!0,l.value="\u7CFB\u7D71\u932F\u8AA4\uFF0C\u8ACB\u6D3D\u7CFB\u7D71\u7BA1\u7406\u54E1",console.error(a)})}return e.response});function L(e){return r({url:`${o.user}/sign_in`,method:"post",data:e})}function T(e){return r({url:`${o.user}/sign_up_check`,method:"post",data:e})}function A(e){return r({url:`${o.user}/sign_up`,method:"post",data:e})}function B(){return r({url:`${o.user}/profile`,method:"get"})}function R(e){return r({url:`${o.user}/profile/${e}`,method:"get"})}function j(e){return r({url:`${o.user}/profile/${e.id}`,method:"patch",data:e.data})}function D(e){return r({url:`${o.user}/updatePassword`,method:"patch",data:e})}function M(e,s=1){let t=o.post;if(e){const a=Object.assign({},e.query);a.currentPage=s,Object.keys(a).forEach((u,c)=>{c===0?t+=`?${u}=${a[u]}`:t+=`&${u}=${a[u]}`})}return console.log(t),r({url:t,method:"get"})}function S(e){return r({url:`${o.post}/${e}`,method:"get"})}function N(e,s,t=1){let a=`${o.post}/${e}`;if(s){const n=Object.assign({},s.query);n.currentPage=t,Object.keys(n).forEach((c,g)=>{g===0?a+=`?${c}=${n[c]}`:a+=`&${c}=${n[c]}`})}return console.log(a),r({url:a,method:"get"})}function V(e){return r({url:o.post,method:"post",data:e})}function q(e){return r({url:`${o.post}/image`,method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function x(e){return r({url:`${o.post}/${e}`,method:"delete"})}function F(e){const{_id:s,content:t,image:a}=e;return r({url:`${o.post}/${s}`,method:"patch",data:{content:t,image:a}})}function G(e){return r({url:`${o.user}/follows/${e}`,method:"get"})}function z(e){return r({url:`${o.user}/follows/${e}`,method:"post"})}function H(e){return r({url:`${o.user}/follows/${e}`,method:"delete"})}function J(e){return r({url:`${o.user}/avatar`,method:"post",headers:{"Content-Type":"multipart/form-data"},data:e})}function K(){return r({url:`${o.post}/likes`,method:"get"})}function Q(e){return r({url:`${o.post}/likes/${e}`,method:"put"})}function W(e){return r({url:`${o.post}/likes/${e}`,method:"delete"})}function X(e,s){return r({url:`${o.post}/comment/${e}`,method:"post",data:{comment:s}})}function Y(e,s){return r({url:`${o.post}/comment/${e}`,method:"patch",data:{comment:s}})}function Z(e){return r({url:`${o.post}/comment/${e}`,method:"delete"})}const ee=I("user",{state:()=>({_id:"",name:"",image:"",follows:[],likes:[]}),actions:{async patchUser(e){this.$patch(p({},e))}}});export{M as a,F as b,S as c,q as d,G as e,H as f,N as g,K as h,x as i,Z as j,B as k,Y as l,X as m,Q as n,W as o,V as p,J as q,j as r,D as s,R as t,ee as u,z as v,L as w,T as x,A as y};
